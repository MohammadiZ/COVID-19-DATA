library(maps) ## Draw geographical maps.
install.packages("maps")
library(maps) ## Draw geographical maps.
library(sf) ## Simple Feature: import, export and manipulate vector data
library(tidyverse) ##Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc
library(units) ## Support for measurement units in R vectors, matrices and arrays: propagation, conversion, derivation
library(rnaturalearth) ## Hold and facilitate interaction with Natural Earth map data
install.packages("rnaturalearth")
library(maps) ## Draw geographical maps.
library(sf) ## Simple Feature: import, export and manipulate vector data
library(tidyverse) ##Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc
library(units) ## Support for measurement units in R vectors, matrices and arrays: propagation, conversion, derivation
library(rnaturalearth) ## Hold and facilitate interaction with Natural Earth map data
head(world.cities) # from the maps package(world cities of population greater than about 40,000)
cities <- st_as_sf(world.cities, coords = c("long", "lat"), crs = 4326)
cities
CA_cities <- filter(cities, country.etc == "Canada")
# create a new label combining name and country
CA_cities <- mutate(CA_cities, city_country = str_c(name, " (", country.etc, ")"))
CA_cities
dist_st.Jh <- st_distance(slice(CA_cities, 663),
slice(CA_cities, c(831, 106, 852)))
dist_st.Jh# distance in meters
set_units(dist_st.Jh, "km")
as.vector(dist_st.Jh) ## shows as a vector
distance_all <- st_distance(CA_cities)
# matrix
dim(distance_all)
# change m to km
distance_all_km <- set_units(distance_all, km)
# replace the distance of 0 m with NA
#distance_all_km[distance_all_km == set_units(0, km)] <- NA
dim(distance_all_km)
write.csv(distance_all_km,"Distance_mat_CA_cities.csv", row.names = FALSE)
##write.table(distance_all_km, file = "foo.csv",  quote = TRUE, sep = ", ", row.names = TRUE, col.names = TRUE, qmethod = "double")
Dis_df <- as.data.frame(distance_all_km)
name_cities <- data.frame(CA_cities$name)
new <- Dis_df
colnames(new) <- name_cities[,1]
distance_all_km_withname <- cbind(name_cities, new)
write.table(distance_all_km_withname, file = "Geographic_distance_CA_cities.csv",  quote = TRUE, sep = ", ", row.names = FALSE, col.names = TRUE, qmethod = "double")
Dis_df <- as.data.frame(distance_all_km)
name_cities <- data.frame(CA_cities$name)
new <- Dis_df
colnames(new) <- name_cities[,1]
distance_all_km_withname <- cbind(name_cities, new)
write.table(distance_all_km_withname, file = "COVID-19-DATA/Data/Geographic_distance_CA_cities.csv",  quote = TRUE, sep = ", ", row.names = FALSE, col.names = TRUE, qmethod = "double")
Dis_df <- as.data.frame(distance_all_km)
name_cities <- data.frame(CA_cities$name)
new <- Dis_df
colnames(new) <- name_cities[,1]
distance_all_km_withname <- cbind(name_cities, new)
write.table(distance_all_km_withname, file = "Geographic_distance_CA_cities.csv",  quote = TRUE, sep = ", ", row.names = FALSE, col.names = TRUE, qmethod = "double")
dist_test<- st_distance(slice(CA_cities, 1),
slice(CA_cities, c(2,5)))
dist_test# distance in meters
set_units(dist_test, "km")
pos <- apply(distance_all_km, 1, which.min)
dist <- apply(distance_all_km, 1, min, na.rm = TRUE)
# add the distance and get the name of the city
CA_cities <- mutate(CA_cities, nearest_city =  city_country[pos],
geometry_nearest = geometry[pos],
distance_city = dist)
world <- ne_countries(scale = "medium", returnclass = "sf", country = 'canada')
world <- ne_countries(scale = "medium", returnclass = "sf", country = 'canada')
library(maps)
data(canada.cities)
library(sf) # the base package manipulating shapes
library(rgdal) # geo data abstraction library
install.packages("rgdal")
library(sf) # the base package manipulating shapes
library(rgdal) # geo data abstraction library
library(geojsonio) # geo json input and output
library(spdplyr) # the `dplyr` counterpart for shapes
install.packages("spdplyr")
library(sf) # the base package manipulating shapes
library(rgdal) # geo data abstraction library
library(geojsonio) # geo json input and output
library(spdplyr) # the `dplyr` counterpart for shapes
library(rmapshaper) # the package that allows geo shape transformation
library(magrittr) # data wrangling
library(dplyr)
library(tidyr)
library(ggplot2)
canada_raw = readOGR(dsn = "data", layer = "gcd_000b11a_e", encoding = 'latin1') # 1
world <- ne_countries(scale = "medium", returnclass = "sf", country = 'canada')
library(rnaturalearthdata)
install.packages("rnaturalearthdata")
library(maps) ## Draw geographical maps.
library(sf) ## Simple Feature: import, export and manipulate vector data
library(tidyverse) ##Collection of packages (visualization, manipulation): ggplot2, dplyr, purrr, etc
library(units) ## Support for measurement units in R vectors, matrices and arrays: propagation, conversion, derivation
library(rnaturalearth) ## Hold and facilitate interaction with Natural Earth map data
library(rnaturalearthdata)
world <- ne_countries(scale = "medium", returnclass = "sf", country = 'canada')
# map
ggplot(world) +
geom_sf(fill = "lightblue", colour = "white") +
geom_sf(data = CA_cities,
aes(size = distance_city),
alpha = 0.7,
fill = "#bd0026",
shape = 21,
show.legend = 'point') +
coord_sf(crs = "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs") +
labs(size = "Distance (km)", title = "Distance to the next city(Canada)") +
theme_void()
library(maps)
library(sf)
library(tidyverse)
library(units)
library(rnaturalearth)
library(rnaturalearthdata)
head(world.cities)
CA_cities <- filter(cities, country.etc == "Canada")
cities <- st_as_sf(world.cities, coords = c("long", "lat"), crs = 4326)
cities
CA_cities <- filter(cities, country.etc == "Canada")
# create a new label combining name and country
CA_cities <- mutate(CA_cities, city_country = str_c(name, " (", country.etc, ")"))
CA_cities
dist_st.Jh <- st_distance(slice(CA_cities, 663),
slice(CA_cities, c(831, 106, 852)))
dist_st.Jh# distance in meters
set_units(dist_st.Jh, "km")
as.vector(dist_st.Jh) ## shows as a vector
distance_all <- st_distance(CA_cities)
# matrix
dim(distance_all)
# change m to km
distance_all_km <- set_units(distance_all, km)
# replace the distance of 0 m with NA
#distance_all_km[distance_all_km == set_units(0, km)] <- NA
dim(distance_all_km)
Dis_df <- as.data.frame(distance_all_km)
name_cities <- data.frame(CA_cities$name)
new <- Dis_df
colnames(new) <- name_cities[,1]
distance_all_km_withname <- cbind(name_cities, new)
View(distance_all_km_withname)
View(new)
write.table(distance_all_km_withname, file = "Geographic_distance_CA_cities.csv",  quote = TRUE, sep = ", ", row.names = FALSE, col.names = TRUE, qmethod = "double")
